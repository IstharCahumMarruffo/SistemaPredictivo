-- SHOW VARIABLES LIKE 'secure_file_priv';
-- DROP TABLE temp_import;
USE desercion_escolar;
CREATE TABLE temp_import(
edo INT,
muni INT,
loca INT,
ageb VARCHAR(100),
f6_res1 INT,
f6_res2 INT,
f6_res3 INT,
f7 INT,
f8e_1 INT,
f8e_2 INT,
f8e_3 INT,
f8e_4 INT,
f8e_5 INT,
f8e_6 INT,
f8e_7 INT,
f8s_1 INT,
f8s_2 INT,
f8s_3 INT,
f8s_4 INT,
f8s_5 INT,
f8s_6 INT,
f8s_7 INT,
f9_1 INT,
f9_2 INT,
f9_3 INT,
f9_4 INT,
f9_5 INT,
f9_6 INT,
f9_7 INT,
f10_1 INT,
f10_2 INT,
f10_3 INT,
f10_4 INT,
f10_5 INT,
f10_6 INT,
f10_7 INT,
f11_1 INT,
f11_2 INT,
f11_3 INT,
f11_4 INT,
f11_5 INT,
f11_6 INT,
f11_7 INT,
f21 INT,
p43a INT,
p44 INT,
p45 FLOAT,
p46 INT,
p47 INT,
p48 INT,
p50h INT,
p50m INT,
p51_1 INT,
p51_2 INT,
p51_3 INT,
p52_1 INT,
p52_2 INT,
p52_3 INT,
p52_4 INT,
p52_5 INT,
p52_6 INT,
p52_7 INT,
p52_8 INT,
p52_9 INT,
p52_10 INT,
p53_1 INT,
p53_2 INT,
p53_3 INT,
p53_4 INT,
p53_5 INT,
p53_6 INT,
p53_7 INT,
p56 INT,
p57 FLOAT,
p58 INT,
p59 INT,
p60 INT,
p62_1 INT,
p62_2 INT,
p63_1 INT,
p63_2 INT,
p63_3 INT,
p63_4 INT,
p63_5 INT,
p63_6 INT,
p63_7 INT,
p63_8 INT,
p63_9 INT,
p63_10 INT,
p63_11 INT,
p63_12 INT,
p63_13 INT,
p63_14 INT,
p63_15 INT,
p63_16 INT,
p63_17 INT,
p63_18 INT,
p63_19 INT,
p63_20 INT,
p63_21 INT,
p63_22 INT,
p63_23 INT,
p67 INT,
p68 INT,
p69 INT,
p70 INT,
p72 INT,
p73_1 INT,
p73_2 INT,
p73_3 INT,
p73_4 INT,
p73_5 INT,
p73_6 INT,
p73_7 INT,
p73_8 INT,
p73_9 INT,
p73_10 INT,
p73_11 INT,
p73_12 INT,
p73_13 INT,
p73_14 INT,
p73_15 INT,
p74a INT,
p74b INT,
p74c INT,
p74d INT,
p74e INT,
p74f INT,
p74g INT,
p74h INT,
p74i INT,
p75 INT,
p76 INT,
p77_1 INT,
p77_2 INT,
p77_3 INT,
p77_4 INT,
p77_5 INT,
p77_6 INT,
p77_7 INT,
p77_8 INT,
p77_9 INT,
p77_10 INT,
p78_1 INT,
p78_2 INT,
p78_3 INT,
p78_4 INT,
p78_5 INT,
p78_6 INT,
p78_7 INT,
p79 INT,
p80 INT,
p81 INT,
p82 INT,
p83 INT,
p85 INT,
p86 INT,
p87 INT,
p88_1 INT,
p88_2 INT,
p88_3 INT,
p88_4 INT,
p88_5 INT,
p88_6 INT,
p88_7 INT,
p88_8 INT,
p88_9 INT,
p88_10 INT,
p88_11 INT,
p88_12 INT,
p88_13 INT,
p88_14 INT,
p88_15 INT,
p88_16 INT,
p88_17 INT,
p88_18 INT,
p88_19 INT,
p88_20 INT,
p88_21 INT,
p88_22 INT,
p88_23 INT,
p89 INT,
p94 INT,
p95_1 INT,
p95_2 INT,
p95_3 INT,
p95_4 INT,
p95_5 INT,
p95_6 INT,
p96_1 INT,
p96_2 INT,
p96_3 INT,
p96_4 INT,
p96_5 INT,
p96_6 INT,
p96_7 INT,
p96_8 INT,
p96_9 INT,
p96_10 INT,
p96_11 INT,
p96_12 INT,
p96_13 INT,
p96_14 INT,
p96_15 INT,
p96_16 INT,
p96_17 INT,
p96_18 INT,
p96_19 INT,
p96_20 INT,
p96_21 INT,
p96_22 INT,
p96_23 INT,
p98_1 INT,
p98_2 INT,
p98_3 INT,
p98_4 INT,
p98_5 INT,
p98_6 INT,
p98_7 INT,
p98_8 INT,
p98_9 INT,
p98_10 INT,
p100 INT,
p103_1 INT,
p103_2 INT,
p104a INT,
p104b INT,
p104c INT,
p104d INT,
p104e INT,
p104f INT,
p104g INT,
p104h INT,
p104i INT,
p2a INT,
p4 INT,
p5 FLOAT,
p6 INT,
p7 INT,
p8 INT,
p10h INT,
p10m INT,
p11_1 INT,
p11_2 INT,
p11_3 INT,
p12_1 INT,
p12_2 INT,
p12_3 INT,
p12_4 INT,
p12_5 INT,
p12_6 INT,
p12_7 INT,
p12_8 INT,
p12_9 INT,
p12_10 INT,
p13_1 INT,
p13_2 INT,
p13_3 INT,
p13_4 INT,
p13_5 INT,
p13_6 INT,
p13_7 INT,
p14 INT,
p15 FLOAT, 
p16 INT,
p17 INT,
p18 INT,
p23_1 INT,
p23_2 INT,
p24_1 INT,
p24_2 INT,
p24_3 INT,
p24_4 INT,
p24_5 INT,
p24_6 INT,
p24_7 INT,
p24_8 INT,
p24_9 INT,
p24_10 INT,
p24_11 INT,
p24_12 INT,
p24_13 INT,
p24_14 INT,
p24_15 INT,
p24_16 INT,
p24_17 INT,
p24_18 INT,
p24_19 INT,
p24_20 INT,
p24_21 INT,
p24_22 INT,
p24_23 INT,
p27 INT,
p29 INT,
p30 INT,
p31 INT,
p39 INT,
p40_1 INT,
p40_2 INT,
p40_3 INT,
p40_4 INT,
p40_5 INT,
p40_6 INT,
p40_7 INT,
p40_8 INT,
p40_9 INT,
p40_10 INT,
p40_11 INT,
p40_12 INT,
p40_13 INT,
p40_14 INT,
p40_15 INT,
p41a INT,
p41b INT,
p41c INT,
p41d INT,
p41e INT,
p41f INT,
p41g INT,
p41h INT,
p41i INT,
s1 INT,
s2a INT,
s9p INT,
s9m INT
) ENGINE=InnoDB;

--

-- LOAD DATA INFILE '/var/lib/mysql-files/ENDEMS.csv'
-- INTO TABLE temp_import
-- FIELDS TERMINATED BY ','
-- LINES TERMINATED BY '\n'
-- IGNORE 1 ROWS;



-- SELECT * FROM temp_import LIMIT 10;
USE desercion_escolar;
INSERT into datos_concluidos (edo, muni, loca, ageb, f6_res1, f6_res2, f6_res3, f7, f8e_1, f8e_2, f8e_3, f8e_4, f8e_5, f8e_6, f8e_7, f8s_1, f8s_2, f8s_3, f8s_4, f8s_5, f8s_6, f8s_7, f9_1, f9_2, f9_3, f9_4, f9_5, f9_6, f9_7, f10_1, f10_2, f10_3, f10_4, f10_5, f10_6, f10_7, f11_1, f11_2, f11_3, f11_4, f11_5, f11_6, f11_7, f21,
p43a, p44, p45, p46, p47, p48, p50h, p50m, p51_1, p51_2, p51_3, p52_1, p52_2, p52_3, p52_4, p52_5, p52_6, p52_7, p52_8, p52_9, p52_10, p53_1, p53_2, p53_3, p53_4, p53_5, p53_6, p53_7, p56, p57, p58, p59, p60, p62_1, p62_2, p63_1, p63_2, p63_3, p63_4, p63_5, p63_6, p63_7, p63_8, p63_9, p63_10, p63_11, p63_12, p63_13, p63_14, p63_15, p63_16, p63_17, p63_18, p63_19, p63_20, p63_21, p63_22, p63_23, p67, p68, p69, p70, p72, p73_1, p73_2, p73_3, p73_4, p73_5, p73_6, p73_7, p73_8, p73_9, p73_10, p73_11, p73_12, p73_13, p73_14, p73_15, p74a, p74b, p74c, p74d, p74e, p74f, p74g, p74h, p74i, s1, s2a, s9p, s9m)
SELECT edo, muni, loca, ageb, f6_res1, f6_res2, f6_res3, f7, f8e_1, f8e_2, f8e_3, f8e_4, f8e_5, f8e_6, f8e_7, f8s_1, f8s_2, f8s_3, f8s_4, f8s_5, f8s_6, f8s_7, f9_1, f9_2, f9_3, f9_4, f9_5, f9_6, f9_7, f10_1, f10_2, f10_3, f10_4, f10_5, f10_6, f10_7, f11_1, f11_2, f11_3, f11_4, f11_5, f11_6, f11_7, f21,
p43a, p44, p45, p46, p47, p48, p50h, p50m, p51_1, p51_2, p51_3, p52_1, p52_2, p52_3, p52_4, p52_5, p52_6, p52_7, p52_8, p52_9, p52_10, p53_1, p53_2, p53_3, p53_4, p53_5, p53_6, p53_7, p56, p57, p58, p59, p60, p62_1, p62_2, p63_1, p63_2, p63_3, p63_4, p63_5, p63_6, p63_7, p63_8, p63_9, p63_10, p63_11, p63_12, p63_13, p63_14, p63_15, p63_16, p63_17, p63_18, p63_19, p63_20, p63_21, p63_22, p63_23, p67, p68, p69, p70, p72, p73_1, p73_2, p73_3, p73_4, p73_5, p73_6, p73_7, p73_8, p73_9, p73_10, p73_11, p73_12, p73_13, p73_14, p73_15, p74a, p74b, p74c, p74d, p74e, p74f, p74g, p74h, p74i, s1, s2a, s9p, s9m
FROM temp_import
WHERE f21=2;

INSERT into datos_no_matriculados (edo, muni, loca, ageb, f6_res1, f6_res2, f6_res3, f7, f8e_1, f8e_2, f8e_3, f8e_4, f8e_5, f8e_6, f8e_7, f8s_1, f8s_2, f8s_3, f8s_4, f8s_5, f8s_6, f8s_7, f9_1, f9_2, f9_3, f9_4, f9_5, f9_6, f9_7, f10_1, f10_2, f10_3, f10_4, f10_5, f10_6, f10_7, f11_1, f11_2, f11_3, f11_4, f11_5, f11_6, f11_7, f21, p75, p76, p77_1, p77_2, p77_3, p77_4, p77_5, p77_6, p77_7, p77_8, p77_9, p77_10, p78_1, p78_2, p78_3, p78_4, p78_5, p78_6, p78_7, p79, p80, p81, p82, p83, p85, p86, p87, p88_1, p88_2, p88_3, p88_4, p88_5, p88_6, p88_7, p88_8, p88_9, p88_10, p88_11, p88_12, p88_13, p88_14, 
p88_15, p88_16, p88_17, p88_18, p88_19, p88_20, p88_21, p88_22, p88_23, p89, p94, p95_1, p95_2, p95_3, p95_4, p95_5, p95_6, p96_1, p96_2, p96_3, p96_4, p96_5, p96_6, p96_7, p96_8, p96_9, p96_10, p96_11, p96_12, p96_13, p96_14, p96_15, p96_16, p96_17, p96_18, p96_19, p96_20, p96_21, p96_22, p96_23, p98_1, p98_2, p98_3, p98_4, p98_5, p98_6, p98_7, p98_8, p98_9, p98_10, p100, p103_1, p103_2, p104a, p104b, p104c, p104d, p104e, p104f, p104g, p104h, p104i,s1, s2a, s9p, s9m)
SELECT edo, muni, loca, ageb, f6_res1, f6_res2, f6_res3, f7, f8e_1, f8e_2, f8e_3, f8e_4, f8e_5, f8e_6, f8e_7, f8s_1, f8s_2, f8s_3, f8s_4, f8s_5, f8s_6, f8s_7, f9_1, f9_2, f9_3, f9_4, f9_5, f9_6, f9_7, f10_1, f10_2, f10_3, f10_4, f10_5, f10_6, f10_7, f11_1, f11_2, f11_3, f11_4, f11_5, f11_6, f11_7, f21, p75, p76, p77_1, p77_2, p77_3, p77_4, p77_5, p77_6, p77_7, p77_8, p77_9, p77_10, p78_1, p78_2, p78_3, p78_4, p78_5, p78_6, p78_7, p79, p80, p81, p82, p83, p85, p86, p87, p88_1, p88_2, p88_3, p88_4, p88_5, p88_6, p88_7, p88_8, p88_9, p88_10, p88_11, p88_12, p88_13, p88_14, p88_15, p88_16, p88_17, 
p88_18, p88_19, p88_20, p88_21, p88_22, p88_23, p89, p94, p95_1, p95_2, p95_3, p95_4, p95_5, p95_6, p96_1, p96_2, p96_3, p96_4, p96_5, p96_6, p96_7, p96_8, p96_9, p96_10, p96_11, p96_12, p96_13, p96_14, p96_15, p96_16, p96_17, p96_18, p96_19, p96_20, p96_21, p96_22, p96_23, p98_1, p98_2, p98_3, p98_4, p98_5, p98_6, p98_7, p98_8, p98_9, p98_10, p100, p103_1, p103_2, p104a, p104b, p104c, p104d, p104e, p104f, p104g, p104h, p104i,s1, s2a, s9p, s9m
FROM temp_import
WHERE f21=3;

INSERT into datos_desertores (edo, muni, loca, ageb, f6_res1, f6_res2, f6_res3, f7, f8e_1, f8e_2, f8e_3, f8e_4, f8e_5, f8e_6, f8e_7, f8s_1, f8s_2, f8s_3, f8s_4, f8s_5, f8s_6, f8s_7, f9_1, f9_2, f9_3, f9_4, f9_5, f9_6, f9_7, f10_1, f10_2, f10_3, f10_4, f10_5, f10_6, f10_7, f11_1, f11_2, f11_3, f11_4, f11_5, f11_6, f11_7, f21, p2a, p4, p5, p6, p7, p8, p10h, p10m, p11_1, p11_2, p11_3, p12_1, p12_2, p12_3, p12_4, p12_5, p12_6, p12_7, p12_8, p12_9, p12_10, p13_1, p13_2, p13_3, p13_4, p13_5, p13_6, p13_7, p14, p15, p16, p17, p18, p23_1, p23_2, p24_1, p24_2, p24_3, p24_4, p24_5, p24_6, p24_7, p24_8, p24_9,
 p24_10, p24_11, p24_12, p24_13, p24_14, p24_15, p24_16, p24_17, p24_18, p24_19, p24_20, p24_21, p24_22, p24_23, p27, p29, p30, p31, p39, p40_1, p40_2, p40_3, p40_4, p40_5, p40_6, p40_7, p40_8, p40_9, p40_10, p40_11, p40_12, p40_13, p40_14, p40_15, p41a, p41b, p41c, p41d, p41e, p41f, p41g, p41h, p41i,s1, s2a, s9p, s9m)
SELECT edo, muni, loca, ageb, f6_res1, f6_res2, f6_res3, f7, f8e_1, f8e_2, f8e_3, f8e_4, f8e_5, f8e_6, f8e_7, f8s_1, f8s_2, f8s_3, f8s_4, f8s_5, f8s_6, f8s_7, f9_1, f9_2, f9_3, f9_4, f9_5, f9_6, f9_7, f10_1, f10_2, f10_3, f10_4, f10_5, f10_6, f10_7, f11_1, f11_2, f11_3, f11_4, f11_5, f11_6, f11_7, f21, p2a, p4, p5, p6, p7, p8, p10h, p10m, p11_1, p11_2, p11_3, p12_1, p12_2, p12_3, p12_4, p12_5, p12_6, p12_7, p12_8, p12_9, p12_10, p13_1, p13_2, p13_3, p13_4, p13_5, p13_6, p13_7, p14, p15, p16, p17, p18, p23_1, p23_2, p24_1, p24_2, p24_3, p24_4, p24_5, p24_6, p24_7, p24_8, p24_9,
 p24_10, p24_11, p24_12, p24_13, p24_14, p24_15, p24_16, p24_17, p24_18, p24_19, p24_20, p24_21, p24_22, p24_23, p27, p29, p30, p31, p39, p40_1, p40_2, p40_3, p40_4, p40_5, p40_6, p40_7, p40_8, p40_9, p40_10, p40_11, p40_12, p40_13, p40_14, p40_15, p41a, p41b, p41c, p41d, p41e, p41f, p41g, p41h, p41i,s1, s2a, s9p, s9m
FROM temp_import
WHERE f21=1;

-- SET SQL_SAFE_UPDATES = 0;

-- DELETE FROM datos_concluidos;
-- DELETE FROM datos_no_matriculados;
-- DELETE FROM datos_desertores;

-- SELECT COUNT(*) FROM temp_import;  -- deber√≠a darte 13014
-- SELECT COUNT(*) FROM datos_concluidos;
-- SELECT COUNT(*) FROM datos_no_matriculados;
-- SELECT COUNT(*) FROM datos_desertores;

-- SELECT COUNT(DISTINCT idC) FROM datos_concluidos;
-- SELECT COUNT(DISTINCT idN) FROM datos__no_matriculados;
-- SELECT COUNT(DISTINCT idD) FROM datos_desertores;

-- SELECT COUNT(*) FROM temp_import WHERE f21 = 1;
-- SELECT COUNT(*) FROM temp_import WHERE f21 = 2;
-- SELECT COUNT(*) FROM temp_import WHERE f21 = 3;

